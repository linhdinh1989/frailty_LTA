/*Latent GOLD syntax for LCA, relaxing local independence assumption and including covariates with direct effects.*/
/*Input: Cross-sectional data at each time point.*/
options
   maxthreads=6;
   algorithm 
      tolerance=1e-008 emtolerance=0.01 emiterations=250 nriterations=50 ;
   startvalues
      seed=0 sets=250 tolerance=1e-005 iterations=1000;
   bayes
      categorical=1 variances=1 latent=1 poisson=1;
   montecarlo
      seed=0 sets=0 replicates=500 tolerance=1e-008;
   quadrature  nodes=10;
   missing  includedependent; 
   output      
      parameters=first  betaopts=wl standarderrors profile probmeans=posterior
      loadings bivariateresiduals classification estimatedvalues=model 
      reorderclasses;
variables
   dependent sph nominal, socialfunc nominal, cogfunc nominal,
      adl nominal, iadl nominal, gali nominal, morbidity nominal, 
      depress nominal;
   independent age, gender;
   latent
      Cluster nominal 4;
equations
   Cluster <- 1 + age + gender;
   sph <- 1 + Cluster;
   socialfunc <- 1 + Cluster;
   cogfunc <- 1 + Cluster +age + gender;
   adl <- 1 + Cluster;
   iadl <- 1 + Cluster + age;
   gali <- 1 + Cluster;
   morbidity <- 1 + Cluster;
   depress <- 1 + Cluster + gender; 
   cogfunc <-> socialfunc;
   depress <-> cogfunc;